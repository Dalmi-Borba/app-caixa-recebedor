<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Caixa ASM</title>
    <link rel="icon" type="image/png" sizes="512x512" href="assets/img/iasdfavicon.png">
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800&amp;display=swap">
</head>
<style>
@import url('https://fonts.googleapis.com/css2?family=Open+Sans&display=swap');

* {
    font-family: 'Open Sans', sans-serif;
}

p {
    color: #000;
}

.content {
    margin: 0 auto;
    max-width: 900px;
    background-color: #eee;
    padding: 10px;
}

.modal {
    background-color: rgba(0, 0, 0, .8);
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    display: none;
}

.modal-content {
    margin: 0 auto;
    margin-top: 3%;
    max-width: 600px;
    background-color: #eee;
    padding: 0;
    box-shadow: 0 0 2px #fff;
}

.modal-header, .modal-body, .modal-footer{
    padding: 5px;
}

.modal-header{
    background-color: #ccc;
}

.modal-footer{
    background-color: #ccc;
}

.link-button { 
     background: none;
     border: none;
     text-decoration: none;
     cursor: pointer; 
}
</style>
<body style="/*background: url(&quot;design.jpg&quot;);*/background-position: 0 -60px;">
    <nav>
        <%- include('./partials/nav'); %>
    </nav>
    <header class="bg-dark pt-5"></header>
    <section class="py-5" style="margin-top: -30px;margin-bottom: -60px;padding-bottom: 72px;">
        <div class="container text-center py-5" style="margin-top: -35px;margin-bottom: -38px;">
            <p class="mb-4" style="font-size: 1.6rem;"></p>
        </div>
    </section>
    <section>
        <p class="text-center" style="color: white;">Listagem de débitos conta corrente igrejas - 1139090/22</p>
        <div class="container bg-dark py-5">
            <div class="row d-flex justify-content-center">
                <div class="col-md-6 col-xl-4">
                    <div>
                        <% items.forEach(function(image) { %>
                            <div class="card shadow-sm">
                                <div class="card-body px-4 py-5 px-md-5">
                                    <div id="aprov<%=image.id%>">
                                        <label>Favorecido:
                                        <span><%= image.nome %></span> 
                                        </label>
                                        <br>
                                        <label for="">Descrição:
                                        <span><%= image.material %></span>
                                        </label> 
                                        <br>
                                        <label for="">Depto:
                                        <span><%=image.depto %></span>
                                        </label>
                                        <br>
                                        <label for="">Valor:
                                        <span><%=image.valor %></span>
                                        </label>
                                        <br>
                                        <label for="">Obs:
                                        <span><%=image.obs %></span>
                                        </label>
                                        <br>
                                        <!---->
                                        
                                     
                                        
                                        <input id="inp<%=image.id%>" type="hidden" value="https://wa.me/5567981563142?text=Autorizo+o+débito+de+<%=image.valor%>+da+IASD+<%=image.nome%>+referente+aos+seguintes+materiais+<%=image.material%>" >
                                        <%if(image.aprovacao == 'false'){%>                                            
                                        <a onclick="openModal('<%=image.id%>')" class="link-primary">Anexo |</a>
                                        <a onclick="update(this)" class="link-button link-warning">Aprovar</a>
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="red" class="bi bi-x-circle" viewBox="0 0 16 16">
                                            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                                            <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                                        </svg>                                                                                                 
                                        <%}else{%>
                                            <a onclick="openModal('<%=image.id%>')" class="link-primary"> Anexo |</a>
                                            <a class="link-success">Aprovado</a>
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="green" class="bi bi-check-circle" viewBox="0 0 16 16">
                                                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                                                <path d="M10.97 4.97a.235.235 0 0 0-.02.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05z"/>
                                              </svg>
                                        <%}%>
                                        <!---->
                                        <div id="<%=image.id%>" class="modal">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <p>Nome: <%= image.nome %></p>
                                                </div>
                                                <div class="modal-body">
                                                    <object data="uploads/<%=image.img.name%>.pdf" type="application/pdf" width="550px" height="550px">
                                                        <embed src="uploads/<%=image.img.name%>.pdf" type="application/pdf">
                                                            <p>This browser does not support PDFs. Please download the PDF to view it: 
                                                            <a href="uploads/<%=image.img.name%>.pdf">Download PDF</a>.</p>
                                                        </embed>
                                                    </object>
                                                </div>
                                                <div class="modal-footer">
                                                    <a onclick="closeModal('<%=image.id%>')" class="link-warning">Fechar</a>
                                                </div>
                                            </div>
                                        </div>
                                        <!---->
                                    </div>         
                                   
                                </div>
                            </div>
                            <br>
                        <% }) %>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="assets/js/bold-and-dark.js"></script>
<script>
function openModal(mn) {
    let modal = document.getElementById(mn);

    if (typeof modal == 'undefined' || modal === null)
        return;

    modal.style.display = 'Block';
    document.body.style.overflow = 'hidden';
}

function closeModal(mn) {
    let modal = document.getElementById(mn);

    if (typeof modal == 'undefined' || modal === null)
        return;

    modal.style.display = 'none';
    document.body.style.overflow = 'auto';
}
//
async function update(btn) {
    let idParent = btn.parentElement.id || child.parentNode.id;
    let id = idParent.replace('aprov', '')
    window.location.href = `http://191.252.101.143:3000/update/${id}`;
    alert("Aprovado! Por favor certifique-se de enviar a mensagem no WhatsApp")
    let url = document.getElementById(`inp${id}`).value
    window.open(url, '_blank');  
};
</script>
</body>

</html>